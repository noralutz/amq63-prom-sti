#!/bin/bash
echo "Before assembling"

/usr/local/s2i/assemble
rc=$?

if [ $rc -eq 0 ]; then

echo "After successful assembling"
PROMCONF=/tmp/src/prometheus_jmx_exporter_configuration
ARTCONF=/tmp/src/artemis_configuration
SRCLIB=/tmp/src/lib

if [ -d ${PROMCONF} ]; then
  echo "Copying artemis config files from project..."
  cp -v ${PROMCONF}/promconfig.yml $AMQ_HOME/etc/
fi

#if [ -d ${ARTCONF} ]; then
#  echo "Copying artemis config files from project..."
#  cp -v ${ARTCONF}/artemis $AMQ_HOME/bin/
#fi

if [ -d ${SRCLIB} ]; then
  echo "Copying jars from project..."
  cp -v ${SRCLIB}/* $AMQ_HOME/lib/
fi

else
    echo "After failed assembling"
fi

exit $rc
